<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>RxAVObject.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">leancloud-typescript-rx-sdk</a> <span class='package-version'>v0.0.9-alpha.1</span></h2><h3>Classes</h3><ul><li><a href="RxAVACL.html">RxAVACL</a><ul class='methods'><li data-type='method'><a href="RxAVACL.html#.RxAVACL">RxAVACL</a></li><li data-type='method'><a href="RxAVACL.html#.RxAVACL">RxAVACL</a></li><li data-type='method'><a href="RxAVACL.html#equals">equals</a></li><li data-type='method'><a href="RxAVACL.html#equals">equals</a></li><li data-type='method'><a href="RxAVACL.html#findWriteAccess">findWriteAccess</a></li><li data-type='method'><a href="RxAVACL.html#findWriteAccess">findWriteAccess</a></li><li data-type='method'><a href="RxAVACL.html#getPublicReadAccess">getPublicReadAccess</a></li><li data-type='method'><a href="RxAVACL.html#getPublicReadAccess">getPublicReadAccess</a></li><li data-type='method'><a href="RxAVACL.html#getPublicWriteAccess">getPublicWriteAccess</a></li><li data-type='method'><a href="RxAVACL.html#getPublicWriteAccess">getPublicWriteAccess</a></li><li data-type='method'><a href="RxAVACL.html#getReadAccess">getReadAccess</a></li><li data-type='method'><a href="RxAVACL.html#getReadAccess">getReadAccess</a></li><li data-type='method'><a href="RxAVACL.html#getRoleReadAccess">getRoleReadAccess</a></li><li data-type='method'><a href="RxAVACL.html#getRoleReadAccess">getRoleReadAccess</a></li><li data-type='method'><a href="RxAVACL.html#getRoleWriteAccess">getRoleWriteAccess</a></li><li data-type='method'><a href="RxAVACL.html#getRoleWriteAccess">getRoleWriteAccess</a></li><li data-type='method'><a href="RxAVACL.html#getWriteAccess">getWriteAccess</a></li><li data-type='method'><a href="RxAVACL.html#getWriteAccess">getWriteAccess</a></li><li data-type='method'><a href="RxAVACL.html#setPublicReadAccess">setPublicReadAccess</a></li><li data-type='method'><a href="RxAVACL.html#setPublicReadAccess">setPublicReadAccess</a></li><li data-type='method'><a href="RxAVACL.html#setPublicWriteAccess">setPublicWriteAccess</a></li><li data-type='method'><a href="RxAVACL.html#setPublicWriteAccess">setPublicWriteAccess</a></li><li data-type='method'><a href="RxAVACL.html#setReadAccess">setReadAccess</a></li><li data-type='method'><a href="RxAVACL.html#setReadAccess">setReadAccess</a></li><li data-type='method'><a href="RxAVACL.html#setRoleReadAccess">setRoleReadAccess</a></li><li data-type='method'><a href="RxAVACL.html#setRoleReadAccess">setRoleReadAccess</a></li><li data-type='method'><a href="RxAVACL.html#setRoleWriteAccess">setRoleWriteAccess</a></li><li data-type='method'><a href="RxAVACL.html#setRoleWriteAccess">setRoleWriteAccess</a></li><li data-type='method'><a href="RxAVACL.html#setWriteAccess">setWriteAccess</a></li><li data-type='method'><a href="RxAVACL.html#setWriteAccess">setWriteAccess</a></li></ul></li><li><a href="RxAVAnalytics.html">RxAVAnalytics</a><ul class='methods'><li data-type='method'><a href="RxAVAnalytics.html#.get">get</a></li><li data-type='method'><a href="RxAVAnalytics.html#.get">get</a></li><li data-type='method'><a href="RxAVAnalytics.html#.init">init</a></li><li data-type='method'><a href="RxAVAnalytics.html#.init">init</a></li><li data-type='method'><a href="RxAVAnalytics.html#.report">report</a></li><li data-type='method'><a href="RxAVAnalytics.html#.report">report</a></li><li data-type='method'><a href="RxAVAnalytics.html#beginEevent">beginEevent</a></li><li data-type='method'><a href="RxAVAnalytics.html#beginEevent">beginEevent</a></li><li data-type='method'><a href="RxAVAnalytics.html#beginPage">beginPage</a></li><li data-type='method'><a href="RxAVAnalytics.html#beginPage">beginPage</a></li><li data-type='method'><a href="RxAVAnalytics.html#closeSesstion">closeSesstion</a></li><li data-type='method'><a href="RxAVAnalytics.html#closeSesstion">closeSesstion</a></li><li data-type='method'><a href="RxAVAnalytics.html#endEvent">endEvent</a></li><li data-type='method'><a href="RxAVAnalytics.html#endEvent">endEvent</a></li><li data-type='method'><a href="RxAVAnalytics.html#endPage">endPage</a></li><li data-type='method'><a href="RxAVAnalytics.html#endPage">endPage</a></li><li data-type='method'><a href="RxAVAnalytics.html#save">save</a></li><li data-type='method'><a href="RxAVAnalytics.html#save">save</a></li><li data-type='method'><a href="RxAVAnalytics.html#send">send</a></li><li data-type='method'><a href="RxAVAnalytics.html#send">send</a></li><li data-type='method'><a href="RxAVAnalytics.html#trackAppOpened">trackAppOpened</a></li><li data-type='method'><a href="RxAVAnalytics.html#trackAppOpened">trackAppOpened</a></li><li data-type='method'><a href="RxAVAnalytics.html#trackAppOpenedWithPush">trackAppOpenedWithPush</a></li><li data-type='method'><a href="RxAVAnalytics.html#trackAppOpenedWithPush">trackAppOpenedWithPush</a></li><li data-type='method'><a href="RxAVAnalytics.html#trackEvent">trackEvent</a></li><li data-type='method'><a href="RxAVAnalytics.html#trackEvent">trackEvent</a></li><li data-type='method'><a href="RxAVAnalytics.html#trackPage">trackPage</a></li><li data-type='method'><a href="RxAVAnalytics.html#trackPage">trackPage</a></li></ul></li><li><a href="RxAVClient.html">RxAVClient</a><ul class='methods'><li data-type='method'><a href="RxAVClient.html#.init">init</a></li><li data-type='method'><a href="RxAVClient.html#.init">init</a></li></ul></li><li><a href="RxAVInstallation.html">RxAVInstallation</a><ul class='methods'><li data-type='method'><a href="RxAVInstallation.html#.current">current</a></li><li data-type='method'><a href="RxAVInstallation.html#.current">current</a></li><li data-type='method'><a href="RxAVInstallation.html#.get">get</a></li><li data-type='method'><a href="RxAVInstallation.html#.get">get</a></li><li data-type='method'><a href="RxAVInstallation.html#.get">get</a></li><li data-type='method'><a href="RxAVInstallation.html#.get">get</a></li><li data-type='method'><a href="RxAVInstallation.html#.get">get</a></li><li data-type='method'><a href="RxAVInstallation.html#.get">get</a></li><li data-type='method'><a href="RxAVInstallation.html#.get">get</a></li><li data-type='method'><a href="RxAVInstallation.html#.get">get</a></li><li data-type='method'><a href="RxAVInstallation.html#.set">set</a></li><li data-type='method'><a href="RxAVInstallation.html#.set">set</a></li><li data-type='method'><a href="RxAVInstallation.html#fetch">fetch</a></li><li data-type='method'><a href="RxAVInstallation.html#fetchRelation">fetchRelation</a></li><li data-type='method'><a href="RxAVInstallation.html#remove">remove</a></li><li data-type='method'><a href="RxAVInstallation.html#save">save</a></li><li data-type='method'><a href="RxAVInstallation.html#save">save</a></li></ul></li><li><a href="RxAVObject.html">RxAVObject</a><ul class='methods'><li data-type='method'><a href="RxAVObject.html#.createSubclass">createSubclass</a></li><li data-type='method'><a href="RxAVObject.html#.createSubclass">createSubclass</a></li><li data-type='method'><a href="RxAVObject.html#.createWithoutData">createWithoutData</a></li><li data-type='method'><a href="RxAVObject.html#.createWithoutData">createWithoutData</a></li><li data-type='method'><a href="RxAVObject.html#.get">get</a></li><li data-type='method'><a href="RxAVObject.html#.get">get</a></li><li data-type='method'><a href="RxAVObject.html#.get">get</a></li><li data-type='method'><a href="RxAVObject.html#.get">get</a></li><li data-type='method'><a href="RxAVObject.html#.saveAll">saveAll</a></li><li data-type='method'><a href="RxAVObject.html#.saveAll">saveAll</a></li><li data-type='method'><a href="RxAVObject.html#.set">set</a></li><li data-type='method'><a href="RxAVObject.html#.set">set</a></li><li data-type='method'><a href="RxAVObject.html#.set">set</a></li><li data-type='method'><a href="RxAVObject.html#.set">set</a></li><li data-type='method'><a href="RxAVObject.html#fetch">fetch</a></li><li data-type='method'><a href="RxAVObject.html#fetch">fetch</a></li><li data-type='method'><a href="RxAVObject.html#fetchRelation">fetchRelation</a></li><li data-type='method'><a href="RxAVObject.html#fetchRelation">fetchRelation</a></li><li data-type='method'><a href="RxAVObject.html#remove">remove</a></li><li data-type='method'><a href="RxAVObject.html#remove">remove</a></li><li data-type='method'><a href="RxAVObject.html#save">save</a></li><li data-type='method'><a href="RxAVObject.html#save">save</a></li></ul></li><li><a href="RxAVPush.html">RxAVPush</a><ul class='methods'><li data-type='method'><a href="RxAVPush.html#.sendContent">sendContent</a></li><li data-type='method'><a href="RxAVPush.html#.sendContent">sendContent</a></li><li data-type='method'><a href="RxAVPush.html#.sendTo">sendTo</a></li><li data-type='method'><a href="RxAVPush.html#.sendTo">sendTo</a></li><li data-type='method'><a href="RxAVPush.html#send">send</a></li><li data-type='method'><a href="RxAVPush.html#send">send</a></li></ul></li><li><a href="RxAVQuery.html">RxAVQuery</a><ul class='methods'><li data-type='method'><a href="RxAVQuery.html#.or">or</a></li><li data-type='method'><a href="RxAVQuery.html#.or">or</a></li><li data-type='method'><a href="RxAVQuery.html#find">find</a></li><li data-type='method'><a href="RxAVQuery.html#find">find</a></li></ul></li><li><a href="RxAVRole.html">RxAVRole</a><ul class='methods'><li data-type='method'><a href="RxAVRole.html#.createWithName">createWithName</a></li><li data-type='method'><a href="RxAVRole.html#.createWithName">createWithName</a></li><li data-type='method'><a href="RxAVRole.html#.createWithoutData">createWithoutData</a></li><li data-type='method'><a href="RxAVRole.html#.createWithoutData">createWithoutData</a></li><li data-type='method'><a href="RxAVRole.html#.RxAVRole">RxAVRole</a></li><li data-type='method'><a href="RxAVRole.html#.RxAVRole">RxAVRole</a></li><li data-type='method'><a href="RxAVRole.html#deny">deny</a></li><li data-type='method'><a href="RxAVRole.html#deny">deny</a></li><li data-type='method'><a href="RxAVRole.html#fetch">fetch</a></li><li data-type='method'><a href="RxAVRole.html#fetchRelation">fetchRelation</a></li><li data-type='method'><a href="RxAVRole.html#grant">grant</a></li><li data-type='method'><a href="RxAVRole.html#grant">grant</a></li><li data-type='method'><a href="RxAVRole.html#remove">remove</a></li><li data-type='method'><a href="RxAVRole.html#save">save</a></li></ul></li><li><a href="RxAVUser.html">RxAVUser</a><ul class='methods'><li data-type='method'><a href="RxAVUser.html#.current">current</a></li><li data-type='method'><a href="RxAVUser.html#.current">current</a></li><li data-type='method'><a href="RxAVUser.html#.get">get</a></li><li data-type='method'><a href="RxAVUser.html#.get">get</a></li><li data-type='method'><a href="RxAVUser.html#.get">get</a></li><li data-type='method'><a href="RxAVUser.html#.get">get</a></li><li data-type='method'><a href="RxAVUser.html#.get">get</a></li><li data-type='method'><a href="RxAVUser.html#.get">get</a></li><li data-type='method'><a href="RxAVUser.html#.logIn">logIn</a></li><li data-type='method'><a href="RxAVUser.html#.logIn">logIn</a></li><li data-type='method'><a href="RxAVUser.html#.logInByMobilephone">logInByMobilephone</a></li><li data-type='method'><a href="RxAVUser.html#.logInByMobilephone">logInByMobilephone</a></li><li data-type='method'><a href="RxAVUser.html#.logInWithMobilephone">logInWithMobilephone</a></li><li data-type='method'><a href="RxAVUser.html#.logInWithMobilephone">logInWithMobilephone</a></li><li data-type='method'><a href="RxAVUser.html#.sendLogInShortcode">sendLogInShortcode</a></li><li data-type='method'><a href="RxAVUser.html#.sendLogInShortcode">sendLogInShortcode</a></li><li data-type='method'><a href="RxAVUser.html#.sendSignUpShortcode">sendSignUpShortcode</a></li><li data-type='method'><a href="RxAVUser.html#.sendSignUpShortcode">sendSignUpShortcode</a></li><li data-type='method'><a href="RxAVUser.html#.set">set</a></li><li data-type='method'><a href="RxAVUser.html#.set">set</a></li><li data-type='method'><a href="RxAVUser.html#.set">set</a></li><li data-type='method'><a href="RxAVUser.html#.set">set</a></li><li data-type='method'><a href="RxAVUser.html#.set">set</a></li><li data-type='method'><a href="RxAVUser.html#.set">set</a></li><li data-type='method'><a href="RxAVUser.html#.signUpByMobilephone">signUpByMobilephone</a></li><li data-type='method'><a href="RxAVUser.html#.signUpByMobilephone">signUpByMobilephone</a></li><li data-type='method'><a href="RxAVUser.html#activate">activate</a></li><li data-type='method'><a href="RxAVUser.html#activate">activate</a></li><li data-type='method'><a href="RxAVUser.html#create">create</a></li><li data-type='method'><a href="RxAVUser.html#create">create</a></li><li data-type='method'><a href="RxAVUser.html#fetch">fetch</a></li><li data-type='method'><a href="RxAVUser.html#fetchRelation">fetchRelation</a></li><li data-type='method'><a href="RxAVUser.html#fetchRoles">fetchRoles</a></li><li data-type='method'><a href="RxAVUser.html#fetchRoles">fetchRoles</a></li><li data-type='method'><a href="RxAVUser.html#inactive">inactive</a></li><li data-type='method'><a href="RxAVUser.html#inactive">inactive</a></li><li data-type='method'><a href="RxAVUser.html#isAuthenticated">isAuthenticated</a></li><li data-type='method'><a href="RxAVUser.html#isAuthenticated">isAuthenticated</a></li><li data-type='method'><a href="RxAVUser.html#logOut">logOut</a></li><li data-type='method'><a href="RxAVUser.html#logOut">logOut</a></li><li data-type='method'><a href="RxAVUser.html#remove">remove</a></li><li data-type='method'><a href="RxAVUser.html#save">save</a></li><li data-type='method'><a href="RxAVUser.html#signUp">signUp</a></li><li data-type='method'><a href="RxAVUser.html#signUp">signUp</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">RxAVObject.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>"use strict";
var SDKPlugins_1 = require('../internal/SDKPlugins');
var MutableObjectState_1 = require('../internal/object/state/MutableObjectState');
var RxLeanCloud_1 = require('../RxLeanCloud');
var rxjs_1 = require('rxjs');
/**
 * 代表的一个 free-schema 的对象
 *
 * @export
 * @class RxAVObject
 */
var RxAVObject = (function () {
    /**
     * RxAVObject 类，代表一个结构化存储的对象.
     * @constructor
     * @param {string} className - className:对象在云端数据库对应的表名.
     */
    function RxAVObject(className) {
        this.estimatedData = {};
        this._isDirty = true;
        this.state = new MutableObjectState_1.MutableObjectState({ className: className });
        this.className = className;
    }
    Object.defineProperty(RxAVObject, "_objectController", {
        get: function () {
            return SDKPlugins_1.SDKPlugins.instance.ObjectControllerInstance;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RxAVObject.prototype, "className", {
        /**
         *  获取当前对象的 className
         *
         *
         * @memberOf RxAVObject
         */
        get: function () {
            return this.state.className;
        },
        /**
         *  设置当前对象的 className
         *
         *
         * @memberOf RxAVObject
         */
        set: function (className) {
            this.state.className = className;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RxAVObject.prototype, "objectId", {
        /**
         * 获取当前对象的 objectId
         *
         *
         * @memberOf RxAVObject
         */
        get: function () {
            return this.state.objectId;
        },
        /**
         * 设置当前对象的 objectId
         *
         *
         * @memberOf RxAVObject
         */
        set: function (id) {
            this._isDirty = true;
            this.state.objectId = id;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RxAVObject.prototype, "isDirty", {
        get: function () {
            return this._isDirty;
        },
        set: function (v) {
            this._isDirty = v;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RxAVObject.prototype, "createdAt", {
        get: function () {
            return this.state.createdAt;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RxAVObject.prototype, "updatedAt", {
        get: function () {
            return this.state.updatedAt;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RxAVObject.prototype, "ACL", {
        get: function () {
            return this._acl;
        },
        set: function (acl) {
            this._acl = acl;
            this.set('ACL', this._acl);
        },
        enumerable: true,
        configurable: true
    });
    RxAVObject.prototype.set = function (key, value) {
        this.isDirty = true;
        this.estimatedData[key] = value;
    };
    RxAVObject.prototype.get = function (key) {
        return this.estimatedData[key];
    };
    /**
     * 将当前对象保存到云端.
     * 如果对象的 objectId 为空云端会根据现有的数据结构新建一个对象并返回一个新的 objectId.
     * @returns {Observable&lt;boolean>}
     *
     * @memberOf RxAVObject
     */
    RxAVObject.prototype.save = function () {
        var _this = this;
        var rtn = rxjs_1.Observable.from([true]);
        if (!this.isDirty)
            return rtn;
        RxAVObject.recursionCollectDirtyChildren(this, [], [], []);
        var dirtyChildren = this.collectAllLeafNodes();
        if (dirtyChildren.length > 0) {
            rtn = RxAVObject.batchSave(dirtyChildren).flatMap(function (sal) { return _this.save(); });
        }
        else {
            rtn = RxAVObject._objectController.save(this.state, this.estimatedData, RxLeanCloud_1.RxAVUser.currentSessionToken).map(function (serverState) {
                _this.handlerSave(serverState);
                return true;
            });
        }
        return rtn;
    };
    /**
     * 从服务端获取数据覆盖本地的数据
     *
     * @returns {Observable&lt;RxAVObject>}
     *
     * @memberOf RxAVObject
     */
    RxAVObject.prototype.fetch = function () {
        var _this = this;
        if (this.objectId == null)
            throw new Error("Cannot refresh an object that hasn't been saved to the server.");
        return RxAVObject._objectController.fetch(this.state, RxLeanCloud_1.RxAVUser.currentSessionToken).map(function (serverState) {
            _this.handleFetchResult(serverState);
            return _this;
        });
    };
    /**
     * 删除指定属性上的值
     *
     * @param {string} key
     *
     * @memberOf RxAVObject
     */
    RxAVObject.prototype.remove = function (key) {
        this.performOperation(key, 'remove');
    };
    /**
     * 根据 className 和 objectId 构建一个对象
     *
     * @static
     * @param {string} classnName 表名称
     * @param {string} objectId objectId
     * @returns {RxAVObject}
     *
     * @memberOf RxAVObject
     */
    RxAVObject.createWithoutData = function (classnName, objectId) {
        var rtn = new RxAVObject(classnName);
        rtn.objectId = objectId;
        return rtn;
    };
    /**
     * 根据子类类型以及 objectId 创建子类实例
     *
     * @static
     * @template T
     * @param {T}
     * @param {string} objectId
     * @returns {T}
     *
     * @memberOf RxAVObject
     */
    RxAVObject.createSubclass = function (ctor, objectId) {
        var rtn = new ctor();
        rtn.objectId = objectId;
        return rtn;
    };
    /**
     * 批量保存 RxAVObject
     *
     * @static
     * @param {Array&lt;RxAVObject>} objects 需要批量保存的 RxAVObject 数组
     *
     * @memberOf RxAVObject
     */
    RxAVObject.saveAll = function (objects) {
        var r;
        objects.map(function (obj) {
            var y = obj.save();
            r = rxjs_1.Observable.concat(y);
        });
        return r;
    };
    RxAVObject.batchSave = function (objArray) {
        var states = objArray.map(function (c) { return c.state; });
        var ds = objArray.map(function (c) { return c.estimatedData; });
        return RxAVObject._objectController.batchSave(states, ds, RxLeanCloud_1.RxAVUser.currentSessionToken).map(function (serverStateArray) {
            objArray.forEach(function (dc, i, a) {
                dc.handlerSave(serverStateArray[i]);
            });
            return true;
        });
    };
    RxAVObject.deepSave = function (obj) {
        var dirtyChildren = [];
        for (var key in obj.estimatedData) {
            var value = obj.estimatedData[key];
            if (value instanceof RxAVObject) {
                if (value.isDirty) {
                    dirtyChildren.push(value);
                }
            }
        }
        if (dirtyChildren.length == 0)
            return rxjs_1.Observable.from([true]);
        return RxAVObject.saveAll(dirtyChildren);
    };
    RxAVObject.prototype.collectDirtyChildren = function () {
        var dirtyChildren = [];
        for (var key in this.estimatedData) {
            var value = this.estimatedData[key];
            if (value instanceof RxAVObject) {
                if (value.isDirty) {
                    dirtyChildren.push(value);
                }
            }
        }
        return dirtyChildren;
    };
    RxAVObject.prototype.collectAllLeafNodes = function () {
        var leafNodes = [];
        var dirtyChildren = this.collectDirtyChildren();
        dirtyChildren.map(function (child) {
            var childLeafNodes = child.collectAllLeafNodes();
            if (childLeafNodes.length == 0) {
                if (child.isDirty) {
                    leafNodes.push(child);
                }
            }
            else {
                leafNodes = leafNodes.concat(childLeafNodes);
            }
        });
        return leafNodes;
    };
    RxAVObject.recursionCollectDirtyChildren = function (root, warehouse, seen, seenNew) {
        var dirtyChildren = root.collectDirtyChildren();
        dirtyChildren.map(function (child) {
            var scopedSeenNew = [];
            if (seenNew.indexOf(child) > -1) {
                throw new Error('Found a circular dependency while saving');
            }
            scopedSeenNew = scopedSeenNew.concat(seenNew);
            scopedSeenNew.push(child);
            if (seen.indexOf(child) > -1) {
                return;
            }
            seen.push(child);
            RxAVObject.recursionCollectDirtyChildren(child, warehouse, seen, scopedSeenNew);
            warehouse.push(child);
        });
    };
    RxAVObject.prototype.handlerSave = function (serverState) {
        this.state.apply(serverState);
        this.isDirty = false;
        //this.rebuildEstimatedData();
    };
    RxAVObject.prototype.handleFetchResult = function (serverState) {
        this.state.apply(serverState);
        this.rebuildEstimatedData();
        this._isNew = false;
        this.isDirty = false;
    };
    RxAVObject.prototype.mergeFromServer = function (serverState) {
        if (serverState.objectId != null) {
        }
    };
    RxAVObject.prototype.rebuildEstimatedData = function () {
        this.estimatedData = {};
        this.estimatedData = this.state.serverData;
    };
    RxAVObject.prototype.setProperty = function (propertyName, value) {
        if (this.state &amp;&amp; this.state != null) {
            this.state.serverData[propertyName] = value;
        }
    };
    RxAVObject.prototype.getProperty = function (propertyName) {
        if (this.state != null) {
            if (this.state.containsKey(propertyName))
                return this.state.serverData[propertyName];
        }
        return null;
    };
    RxAVObject.prototype.performOperation = function (key, operation) {
        if (operation == 'remove') {
            this.set(key, { __op: 'Delete' });
        }
    };
    RxAVObject.prototype.buildRelation = function (op, opEntities) {
        if (opEntities) {
            var action = op == 'add' ? 'AddRelation' : 'RemoveRelation';
            var body = {};
            var encodedEntities = SDKPlugins_1.SDKPlugins.instance.Encoder.encodeItem(opEntities);
            body = {
                __op: action,
                'objects': encodedEntities
            };
            return body;
        }
    };
    /**
     * 查询 Relation 包含的对象数组
     *
     * @param {string} key
     * @param {any} targetClassName
     * @returns {Observable&lt;RxAVObject[]>}
     *
     * @memberOf RxAVObject
     */
    RxAVObject.prototype.fetchRelation = function (key, targetClassName) {
        var query = new RxLeanCloud_1.RxAVQuery(targetClassName);
        query.relatedTo(this, key);
        return query.find();
    };
    RxAVObject.saveToLocalStorage = function (entity, key) {
        if (SDKPlugins_1.SDKPlugins.instance.hasStorage) {
            if (entity == null) {
                return SDKPlugins_1.SDKPlugins.instance.LocalStorageControllerInstance.remove(key).map(function (provider) {
                    return provider != null;
                });
            }
            else {
                return SDKPlugins_1.SDKPlugins.instance.LocalStorageControllerInstance.set(key, entity.toJSONObjectForSaving()).map(function (provider) {
                    return provider != null;
                });
            }
        }
        return rxjs_1.Observable.from([true]);
    };
    RxAVObject.prototype.toJSONObjectForSaving = function () {
        var data = this.estimatedData;
        data['objectId'] = this.objectId;
        data['createdAt'] = this.createdAt;
        data['updatedAt'] = this.updatedAt;
        var encoded = SDKPlugins_1.SDKPlugins.instance.Encoder.encode(data);
        return encoded;
    };
    return RxAVObject;
}());
exports.RxAVObject = RxAVObject;
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Wed Mar 01 2017 16:30:53 GMT+0800 (CST) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
